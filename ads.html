<!-- ads.html -->
<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Watch Ad</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>
  <div class="card center">
    <h2>üì∫ Watch Ad & Earn</h2>
    <div style="margin-top:12px">
      <!-- Place ad area (Adsterra / Monetag script can go here) -->
      <div id="adArea" style="width:100%;height:250px;border-radius:10px;border:1px solid #eef7ff;display:flex;align-items:center;justify-content:center;">
        <small class="small">Ad will display here on a live host</small>
      </div>

      <p id="adTimer" class="small">Press "Start Ad" and wait 15s to claim reward</p>
      <button id="startAdBtn" class="btn">‚ñ∂ Start Ad (15s)</button>
      <button id="claimAdBtn" class="btn ghost" disabled style="display:block;margin-top:8px">‚úÖ Claim Reward</button>
    </div>
  </div>

  <script type="module">
    import './app.js';
    const startBtn = document.getElementById('startAdBtn');
    const claimBtn = document.getElementById('claimAdBtn');
    const adTimer = document.getElementById('adTimer');

    let countdown;

    startBtn.addEventListener('click', async ()=>{
      // OPTIONAL: inject monetag/adsterra script here (works on live host)
      // document.getElementById('adArea').innerHTML = "<script src='//pl275...'></script>";

      let t = 15;
      startBtn.disabled = true;
      adTimer.innerText = `‚è≥ Wait ${t}s...`;
      claimBtn.disabled = true;
      countdown = setInterval(()=>{
        t--;
        adTimer.innerText = `‚è≥ Wait ${t}s...`;
        if(t<=0){
          clearInterval(countdown);
          adTimer.innerText = "‚úÖ Ad finished! Press claim to get coins";
          claimBtn.disabled = false;
        }
      },1000);
    });

    claimBtn.addEventListener('click', async ()=>{
      const user = window.appHelpers.getTelegramUser();
      const id = user?.id || localStorage.getItem('guest_user');
      if(!id){ alert("Open inside Telegram or set guest id."); return; }

      // give coins (example 10)
      await window.appHelpers.addCoinsToUser(id, 10);
      claimBtn.disabled = true;
      startBtn.disabled = false;
      adTimer.innerText = "‚úÖ Claimed 10 coins";
    });
  </script>
</body>
</html>
